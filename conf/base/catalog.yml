# Documentation for this file format can be found in "The Data Catalog"
# Link: https://docs.kedro.org/en/stable/data/data_catalog.html
_js: &_js
  type: json.JSONDataset
  credentials: s3_credentials

_pq: &_pq
  type: pandas.ParquetDataset
  credentials: s3_credentials
  load_args:
    engine: pyarrow

_pq_ptd: &_pq_ptd
  type: partitions.PartitionedDataset
  dataset: 
    type: pandas.ParquetDataset
    save_args:
      engine: pyarrow
    load_args:
      engine: pyarrow
  filename_suffix: '.parquet'
  credentials: s3_credentials

_csv: &_csv
  type: pandas.CSVDataset
  credentials: s3_credentials

_txt: &_txt
  type: text.TextDataset
  credentials: s3_credentials

_image: &_image
  type: pillow.ImageDataset
  credentials: s3_credentials

_pkl: &_pkl
  type: pickle.PickleDataset
  credentials: s3_credentials
  backend: pickle

_js_ptd: &_js_ptd
  type: partitions.PartitionedDataset
  dataset: json.JSONDataset
  filename_suffix: ".json"
  credentials: s3_credentials

_csv_ptd: &_csv_ptd
  type: partitions.PartitionedDataset
  dataset:
    type: pandas.CSVDataset
    save_args:
      index: False
  filename_suffix: '.csv'
  credentials: s3_credentials

gtr.data_collection.publications.raw:
  <<: *_pq_ptd
  path: s3://igl-dsit-impact/03_impact/data/01_raw/gtr/publications/

gtr.data_collection.publications.intermediate: &gtr_input_publications
  <<: *_pq
  filepath: s3://igl-dsit-impact/03_impact/data/02_intermediate/gtr/publications/main.parquet

oa.data_matching.gtr.input:
  <<: *gtr_input_publications

oa.data_matching.gtr.doi.raw:
  <<: *_js_ptd
  path: s3://igl-dsit-impact/03_impact/data/01_raw/oa/gtr/doi/

oa.data_matching.gtr.doi.intermediate:
  <<: *_pq
  filepath: s3://igl-dsit-impact/03_impact/data/02_intermediate/oa/gtr/doi/main.parquet
  
cr.data_matching.gtr.doi.raw:
  <<: *_pq_ptd
  path: s3://igl-dsit-impact/03_impact/data/01_raw/cr/matches/

cr.data_matching.gtr.doi.intermediate:
  <<: *_pq
  filepath: s3://igl-dsit-impact/03_impact/data/02_intermediate/cr/matches/main.parquet

oa_search.data_matching.gtr.doi.raw:
  <<: *_pq_ptd
  path: s3://igl-dsit-impact/03_impact/data/01_raw/oa_search/matches/

oa_search.data_matching.gtr.doi.intermediate:
  <<: *_pq
  filepath: s3://igl-dsit-impact/03_impact/data/02_intermediate/oa_search/matches/main.parquet

oa_search.data_matching.gtr.doi.best_match.intermediate:
  <<: *_pq
  filepath: s3://igl-dsit-impact/03_impact/data/02_intermediate/oa_search/best_match/main.parquet

oa_search.data_matching.gtr.doi.combined.intermediate:
  <<: *_pq
  filepath: s3://igl-dsit-impact/03_impact/data/02_intermediate/oa_search/combined/main.parquet

oa.data_matching.gtr.combined.doi.raw:
  <<: *_js_ptd
  path: s3://igl-dsit-impact/03_impact/data/01_raw/oa/gtr/combined/doi/

oa.data_matching.gtr.combined.doi.intermediate:
  <<: *_pq
  filepath: s3://igl-dsit-impact/03_impact/data/02_intermediate/oa/gtr/combined/doi/main.parquet

oa.data_matching.gtr.combined.id.raw:
  <<: *_js_ptd
  path: s3://igl-dsit-impact/03_impact/data/01_raw/oa/gtr/combined/id/

oa.data_matching.gtr.combined.id.intermediate:
  <<: *_pq
  filepath: s3://igl-dsit-impact/03_impact/data/02_intermediate/oa/gtr/combined/id/main.parquet

oa.publications.gtr.primary: &_oa_publications
  <<: *_pq
  filepath: s3://igl-dsit-impact/03_impact/data/03_primary/oa/gtr/publications/main.parquet

oa.publications.gtr.map.primary:
  <<: *_pq
  filepath: s3://igl-dsit-impact/03_impact/data/03_primary/oa/gtr/map/main.parquet

s2.citation_details.raw:
  <<: *_pq_ptd
  path: s3://igl-dsit-impact/03_impact/data/01_raw/s2/citation_details/

s2.paper_details.raw:
  <<: *_pq_ptd
  path: s3://igl-dsit-impact/03_impact/data/01_raw/s2/paper_details/

s2.citation_details.intermediate: &_s2_citation_details
  <<: *_pq
  filepath: s3://igl-dsit-impact/03_impact/data/02_intermediate/s2/citation_details/main.parquet

s2.paper_details.intermediate:
  <<: *_pq
  filepath: s3://igl-dsit-impact/03_impact/data/02_intermediate/s2/paper_details/main.parquet

pdfs.oa_dataset.input: 
  <<: *_oa_publications
  load_args:
    engine: pyarrow
    columns:
      - 'id'
      - 'title'

pdfs.s2_dataset.input:
  <<: *_s2_citation_details
  load_args:
    engine: pyarrow
    columns:
      - 'id'
      - 'pdf_url'
      - 'context'
      - 'doi'
      - 'mag_id'
      - 'pmid'

pdfs.section_details.input:
  <<: *_pq
  filepath: s3://igl-dsit-impact/03_impact/data/01_raw/pdfs/citation_details/section_inputs.parquet

pdfs.objects.raw:
  type: partitions.PartitionedDataset
  dataset: dsit_impact.datasets.pdf_dataset.PdfDataset
  path: s3://igl-dsit-impact/03_impact/data/01_raw/pdfs/objects/
  credentials: s3_credentials

pdfs.section_details.raw:
  <<: *_pq_ptd
  path: s3://igl-dsit-impact/03_impact/data/01_raw/pdfs/citation_sections/

pdfs.section_shares.intermediate:
  <<: *_pq
  filepath: s3://igl-dsit-impact/03_impact/data/02_intermediate/pdfs/citation_sections/shares.parquet

authors.oa_dataset.input:
  <<: *_oa_publications
  load_args:
    engine: pyarrow
    columns:
      - 'id'
      - 'authorships'

authors.oa_dataset.raw:
  <<: *_pq_ptd
  path: s3://igl-dsit-impact/03_impact/data/01_raw/oa/authors/past_publications/


"authors.{level}.aggregates.intermediate":
  <<: *_pq
  filepath: s3://igl-dsit-impact/03_impact/data/02_intermediate/authors/aggregates/{level}.parquet

# "authors.{level}.aggregates.intermediate":
#   <<: *_pq
#   filepath: s3://igl-dsit-impact/03_impact/data/02_intermediate/authors/aggregates/{level}.parquet

"authors.{level}.diversity_components.intermediate":
  <<: *_pq
  filepath: s3://igl-dsit-impact/03_impact/data/02_intermediate/authors/diversity_components/{level}.parquet

cwts.topics.input:
  type: pandas.ExcelDataset
  filepath: s3://igl-dsit-impact/03_impact/data/01_raw/cwts/cwts_oa_topics.xlsx

"cwts.topics.{level}.distance_matrix":
  <<: *_pq
  filepath: s3://igl-dsit-impact/03_impact/data/02_intermediate/cwts/distance_matrices/{level}.parquet

"publications.{level}.paper_diversity_scores.intermediate":
  <<: *_pq
  filepath: s3://igl-dsit-impact/03_impact/data/02_intermediate/publications/paper_diversity_scores/{level}.parquet

"publications.{level}.coauthor_diversity_scores.intermediate":
  <<: *_pq
  filepath: s3://igl-dsit-impact/03_impact/data/02_intermediate/publications/coauthor_diversity_scores/{level}.parquet